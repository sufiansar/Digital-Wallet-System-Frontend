import{j as s,V as $,W as R,X as V,Y as p,Z,_ as A,$ as B,a0 as X,a1 as Y,a2 as q,a3 as G,r as P,u as b,a as y,B as d,F as N,b as i,c,d as m,e as x,I as v,f as h,a4 as C,o as I,t as u,s as j}from"./index-CcoH4oKZ.js";import{f as H}from"./user.api-ieHgYxcs.js";import{L as F}from"./Loading-CydpJtcl.js";function S({...e}){return s.jsx($,{"data-slot":"dialog",...e})}function O({...e}){return s.jsx(R,{"data-slot":"dialog-trigger",...e})}function Q({...e}){return s.jsx(X,{"data-slot":"dialog-portal",...e})}function W({className:e,...a}){return s.jsx(Y,{"data-slot":"dialog-overlay",className:p("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...a})}function z({className:e,children:a,showCloseButton:g=!0,...o}){return s.jsxs(Q,{"data-slot":"dialog-portal",children:[s.jsx(W,{}),s.jsxs(V,{"data-slot":"dialog-content",className:p("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...o,children:[a,g&&s.jsxs(Z,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[s.jsx(A,{}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function D({className:e,...a}){return s.jsx("div",{"data-slot":"dialog-header",className:p("flex flex-col gap-2 text-center sm:text-left",e),...a})}function U({className:e,...a}){return s.jsx(B,{"data-slot":"dialog-title",className:p("text-lg leading-none font-semibold",e),...a})}const J=I({name:j().optional(),phone:j().optional()}),K=I({oldPassword:j().min(6,"Old password is required"),newPassword:j().min(6,"Password must be at least 6 characters").refine(e=>/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{6,}$/.test(e),"Password must include letters, numbers, and a special character")});function os(){const[e,{isLoading:a}]=H(),[g,{isLoading:o}]=q(),{data:l}=G(void 0),[k,f]=P.useState(!1),[L,w]=P.useState(!1),n=b({resolver:y(J),defaultValues:{name:"",phone:""}}),r=b({resolver:y(K),defaultValues:{oldPassword:"",newPassword:""}}),_=async t=>{const M=Object.fromEntries(Object.entries(t).filter(([ss,T])=>T!==""));try{await e(M).unwrap(),u.success("Profile updated successfully"),n.reset(),f(!1)}catch{u.error("Failed to update profile")}},E=async t=>{try{await g(t).unwrap(),u.success("Password changed successfully"),r.reset(),w(!1)}catch{u.error("Failed to change password")}};return s.jsxs("div",{className:"max-w-md mx-auto bg-white dark:bg-gray-900 rounded-xl shadow-md p-6 space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Profile Information"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",l?.data?.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Email:"})," ",l?.data?.email]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Phone:"})," ",l?.data?.phone]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Role:"})," ",l?.data?.role]})]}),s.jsxs(S,{open:k,onOpenChange:f,children:[s.jsx(O,{asChild:!0,children:s.jsx(d,{className:"w-full",children:"Update Profile"})}),s.jsxs(z,{className:"sm:max-w-md",children:[s.jsx(D,{children:s.jsx(U,{children:"Update Your Information"})}),a?s.jsx("p",{className:"flex justify-center items-center h-32",children:s.jsx(F,{})}):s.jsx(N,{...n,children:s.jsxs("form",{onSubmit:n.handleSubmit(_),className:"space-y-3",children:[s.jsx(i,{control:n.control,name:"name",render:({field:t})=>s.jsxs(c,{children:[s.jsx(m,{children:"Full Name"}),s.jsx(x,{children:s.jsx(v,{placeholder:"Name",...t})}),s.jsx(h,{})]})}),s.jsx(i,{control:n.control,name:"phone",render:({field:t})=>s.jsxs(c,{children:[s.jsx(m,{children:"Phone"}),s.jsx(x,{children:s.jsx(v,{placeholder:"Phone",...t})}),s.jsx(h,{})]})}),s.jsx(d,{type:"submit",className:"w-full",disabled:a,children:a?"Updating...":"Save Changes"})]})})]})]}),s.jsxs(S,{open:L,onOpenChange:w,children:[s.jsx(O,{asChild:!0,children:s.jsx(d,{variant:"secondary",className:"w-full",children:"Change Password"})}),s.jsxs(z,{className:"sm:max-w-md",children:[s.jsx(D,{children:s.jsx(U,{children:"Change Password"})}),o?s.jsx("p",{className:"flex justify-center items-center h-32",children:s.jsx(F,{})}):s.jsx(N,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(E),className:"space-y-3",children:[s.jsx(i,{control:r.control,name:"oldPassword",render:({field:t})=>s.jsxs(c,{children:[s.jsx(m,{children:"Old Password"}),s.jsx(x,{children:s.jsx(C,{...t})}),s.jsx(h,{})]})}),s.jsx(i,{control:r.control,name:"newPassword",render:({field:t})=>s.jsxs(c,{children:[s.jsx(m,{children:"New Password"}),s.jsx(x,{children:s.jsx(C,{...t})}),s.jsx(h,{})]})}),s.jsx(d,{type:"submit",className:"w-full",disabled:o,children:o?"Changing...":"Change Password"})]})})]})]})]})}export{os as P};
